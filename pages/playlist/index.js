"use strict";const e=require("../../common/vendor.js"),l=require("../../utils/system.js"),o=require("../../store/modules/list.js"),t=require("../../store/modules/player.js"),a=require("../../utils/playInfoStorage.js"),s=require("../../utils/api/music.js"),i=require("../../utils/api/songlist.js"),n=require("../../utils/api/songlist-direct.js"),r=require("../../utils/musicUrlCache.js"),u=require("../../utils/musicSwitchSourceStorage.js"),c=require("../../utils/musicParams.js"),d=require("../../utils/imageProxy.js");Math||(v+S+g+m+f+y+p)();const v=()=>"../../uni_modules/roc-icon-plus/components/roc-icon-plus/roc-icon-plus.js",g=()=>"../../components/common/CustomTabBar.js",m=()=>"../../components/player/MiniPlayer.js",f=()=>"../../components/player/MusicToggleModal.js",y=()=>"../../components/common/AutoUpdateToast.js",p=()=>"../../components/common/LoadingToast.js",S=()=>"../../components/common/VirtualList.js",h="listPrevSelectId",I={__name:"index",setup(v){const g=e.ref(!1);e.computed(()=>l.getSafeAreaStyle());const m=e.ref(l.getStatusBarHeight());e.ref(l.getNavbarHeight());const f=e.computed(()=>({paddingTop:`${m.value}px`})),y=e.computed(()=>({paddingTop:`${m.value}px`})),p=e.computed(()=>o.listStore.state.defaultList.list.length),S=e.computed(()=>o.listStore.state.loveList.list.length),I=e.ref(!1),P=e.ref(""),L=e.ref(""),U=e.ref(""),T=e.ref(""),x=e.ref(!1),w=e.ref(null),D=e.ref(-1),_=e.ref(!1),b=e.ref(null),k=e.ref(-1),A=e.ref("custom"),E=e.ref(!1),C=e.ref(null),M=e.ref(!1),F=e.ref(""),$=e.ref(!1),O=e.ref("加载中"),j=e.ref(""),q=e.ref(!1),V=e.ref([]),z=e.ref(""),R=e.ref([]),W=e.ref(new Set),N=e.ref(!1),B=e.ref(!1),H=l=>{try{e.index.setStorageSync(h,l),console.log("[Playlist] 保存上次选择的歌单ID:",l)}catch(o){console.error("[Playlist] 保存歌单ID失败:",o)}},Q=e.ref(!1),J=e.ref(0);e.computed(()=>{const l=J.value;if(Q.value){const o=e.index.getSystemInfoSync().windowWidth/750*140;return{height:`${o-o/10+l}px`}}return{height:`${l}px`}});const K=()=>{N.value="true"===e.index.getStorageSync("darkMode"),console.log("[Playlist] 初始化暗黑模式:",N.value)},X=()=>{R.value=o.listStore.state.userLists.map(e=>({id:e.id,name:e.name,coverImgUrl:e.coverImgUrl||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",trackCount:e.list?e.list.length:0}))};e.watch(()=>o.listStore.state.userLists,()=>{X()},{deep:!0}),e.onMounted(()=>{K(),X(),console.log("[Playlist] ====== onMounted 快速初始化 ======"),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(()=>{setTimeout(()=>{We()},100)}):setTimeout(()=>{We()},200)});const G=e.ref("trial"),Y=e.reactive({id:"trial",name:"试听列表",coverImgUrl:"",creator:{nickname:"拼好歌官方",avatarUrl:""},description:"试听列表，存放您最近试听的歌曲",trackCount:0,playCount:0}),Z=e.ref([]),ee=e.ref(!1),le=l=>{if(!Array.isArray(l))return console.warn("[Playlist] setSongList: allSongs 不是数组",typeof l,l),Z.value=[],void($.value=!1);const o=l.length;console.log("[Playlist] setSongList: 准备加载",o,"首歌曲"),o>100?($.value=!0,O.value="正在加载",j.value=`${o}首歌曲`,e.nextTick$1(()=>{Z.value=l,setTimeout(()=>{$.value=!1},300)})):Z.value=l,console.log(`[Playlist] 已设置歌曲列表，共 ${o} 首`)},oe=e.computed(()=>t.playerStore.state.isPlaying),te=e.computed(()=>t.playerStore.state.isPlaying),ae=e.computed(()=>{const e=o.listStore.state.playInfo.playerListId,l=o.listStore.state.tempList.meta,t=e===o.LIST_IDS.TEMP&&l.id===G.value;if(e!==("trial"===G.value||G.value===o.LIST_IDS.DEFAULT?o.LIST_IDS.DEFAULT:"favorite"===G.value||G.value===o.LIST_IDS.LOVE?o.LIST_IDS.LOVE:G.value)&&!t)return-1;const a=o.listStore.state.playInfo.playIndex;return a>=0&&a<Z.value.length?a:-1});e.computed(()=>ae.value>=0&&Z.value.length>ae.value?Z.value[ae.value]:null);const se=e.ref(0),ie=e.ref(""),ne=e.ref(null),re=e.computed(()=>{const l=(e.index.getSystemInfoSync().windowHeight||667)-m.value-44-50-(Q.value?56:0)-J.value;return`${Math.max(l,300)}px`}),ue=e=>{},ce=({index:e,item:l})=>{console.log("[VirtualList] 点击歌曲:",e,l.name),Le(e)},de=({index:e,item:l})=>{console.log("[VirtualList] 点击更多:",e,l.name),Te(l,e)},ve=()=>{g.value=!g.value,g.value&&(console.log("========== [Sidebar] 侧边栏打开 =========="),console.log("[Sidebar] 当前选中歌单 currentPlaylistId:",G.value),console.log("[Sidebar] 已导入歌单数量:",V.value.length),V.value.forEach((e,l)=>{console.log(`[Sidebar] [${l}] id="${e.id}" name="${e.name}" platform="${e.platform}" active=${G.value===e.id}`)}),console.log("=========================================="))},ge=()=>{g.value=!1},me=(e,l,o)=>{if(!l||!l.coverImgUrl)return;let t=0;l.coverImgUrl.includes("wsrv.nl")?t=1:l.coverImgUrl.includes("weserv.nl")?t=2:l.coverImgUrl.includes("jina.ai")&&(t=3);const a=d.handleImageError(e,l.coverImgUrl,t);a&&(l.coverImgUrl=a)},fe=(e,l=!1)=>{if(q.value)console.log("[Playlist] 歌单正在加载中，阻止切换");else{if(console.log("========== [Playlist] selectPlaylist 被调用 =========="),console.log("[Playlist] 传入的 playlistId:",e,"forceReload:",l),console.log("[Playlist] 当前 currentPlaylistId:",G.value),G.value===e&&!l)return console.log("[Playlist] 歌单已选中，关闭侧边栏"),void(g.value=!1);if(G.value=e,g.value=!1,H(e),"trial"===e||e===o.LIST_IDS.DEFAULT)Y.id=o.LIST_IDS.DEFAULT,Y.name="试听列表",Y.description="试听列表，存放您最近试听的歌曲",z.value="";else if("favorite"===e||e===o.LIST_IDS.LOVE)Y.id=o.LIST_IDS.LOVE,Y.name="我的收藏",Y.description="您收藏的歌曲",z.value="";else if(e.startsWith("custom_")||e.startsWith("userlist_")){const l=o.listStore.state.userLists.find(l=>l.id===e);if(l){console.log("[Playlist] 选择自定义歌单:",l.name),Y.id=l.id,Y.name=l.name,Y.coverImgUrl=l.coverImgUrl||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",Y.description="自定义歌单",z.value="custom";const e=l.list||[];return le(e),se.value=0,void console.log("[Playlist] 自定义歌单歌曲数:",e.length)}}Z.value=[],Ie()}},ye=[{name:"网易云音乐",source:"wy"},{name:"QQ音乐",source:"tx"},{name:"酷狗音乐",source:"kg"},{name:"酷我音乐",source:"kw"},{name:"咪咕音乐",source:"mg"}],pe=()=>{e.index.showModal({title:"新建歌单",editable:!0,placeholderText:"你想起啥名...",success:l=>{if(l.confirm&&l.content){const t=l.content.trim();if(!t)return void e.index.showToast({title:"歌单名称不能为空",icon:"none"});if(o.listStore.state.userLists.some(e=>e.name===t))return void e.index.showModal({title:"提示",content:"已存在同名歌单，是否继续创建？",success:e=>{e.confirm&&Se(t)}});Se(t)}}})},Se=l=>{const t=o.listStore.createUserList(l);t&&(X(),g.value=!0,e.index.showToast({title:"创建成功",icon:"success"}),console.log("[createNewPlaylist] 新建歌单成功:",t.name,"ID:",t.id))},he=()=>{e.index.showActionSheet({itemList:ye.map(e=>e.name),success:e=>{const l=ye[e.tapIndex];U.value=l.source,T.value=l.name,P.value=`从${l.name}导入`,L.value="",I.value=!0}})},Ie=async()=>{var l;if(!ee.value){ee.value=!0;try{if("trial"===G.value||G.value===o.LIST_IDS.DEFAULT)console.log("[fetchSongs] 从试听列表获取歌曲，数量:",o.listStore.state.defaultList.list.length),Z.value=[...o.listStore.state.defaultList.list];else if("favorite"===G.value||G.value===o.LIST_IDS.LOVE)console.log("[fetchSongs] 从收藏列表获取歌曲，数量:",o.listStore.state.loveList.list.length),Z.value=[...o.listStore.state.loveList.list];else if(G.value.startsWith("custom_")||G.value.startsWith("userlist_")){const e=o.listStore.state.userLists.find(e=>e.id===G.value);console.log("[fetchSongs] 从自定义歌单获取歌曲，歌单ID:",G.value,"歌曲数量:",(null==(l=null==e?void 0:e.list)?void 0:l.length)||0),e&&e.list?Z.value=[...e.list]:Z.value=[]}else{const l=(e.index.getStorageSync("imported_playlists")||[]).find(e=>e.id===G.value);if(l&&l.songs){console.log("[fetchSongs] 从导入的歌单获取歌曲，歌单ID:",G.value,"歌曲数量:",l.songs.length);const e=l.songs.map(e=>({...e,ar:e.ar||(e.singer?e.singer.split("/").map(e=>({name:e})):[])}));Z.value=e}else console.log("[fetchSongs] 未找到导入歌单数据"),Z.value=[]}console.log("[fetchSongs] 加载完成，共:",Z.value.length,"首")}catch(t){console.error("[fetchSongs] 获取歌曲列表失败:",t)}finally{ee.value=!1}}},Pe=()=>{console.log("[Playlist] onScrollToLower 触发，已加载全部",Z.value.length,"首歌曲")},Le=l=>{if(ae.value===l)return void(oe.value?t.playerStore.pause():t.playerStore.resume());const a="trial"===G.value||G.value===o.LIST_IDS.DEFAULT?o.LIST_IDS.DEFAULT:"favorite"===G.value||G.value===o.LIST_IDS.LOVE?o.LIST_IDS.LOVE:G.value;o.listStore.setPlayerListId(a),(async l=>{var a,s;const i=Z.value[l];if(i){console.log("[Playlist] ========== 开始播放歌曲 =========="),console.log("[Playlist] 歌曲索引:",l),console.log("[Playlist] 歌曲名称:",i.name);try{Z.value.length>0&&(console.log("[Playlist] 播放歌曲，设置临时列表"),o.listStore.setTempList(o.LIST_IDS.TEMP,Z.value,{id:Y.id,source:z.value||"",name:Y.name}),o.listStore.setPlayerListId(o.LIST_IDS.TEMP),o.listStore.updatePlayIndexByListId(o.LIST_IDS.TEMP,i.id),console.log("[Playlist] 列表ID:",o.LIST_IDS.TEMP,"播放索引:",l));const e={id:i.id,name:i.name,singer:i.ar?i.ar.map(e=>e.name).join("/"):i.singer||"",ar:i.ar||(i.singer?i.singer.split("/").map(e=>({name:e})):[]),album:(null==(a=i.al)?void 0:a.name)||i.albumName||i.album||"",duration:i.dt||i.interval||i.duration,source:i.source||"tx",songmid:i.songmid,hash:i.hash,copyrightId:i.copyrightId,img:(null==(s=i.al)?void 0:s.picUrl)||i.img||i.albumPic||"",url:"",playUrl:"",lyric:i.lyric||"",tlyric:i.tlyric||"",rlyric:i.rlyric||"",lxlyric:i.lxlyric||""};o.listStore.setPlayMusicInfo(o.LIST_IDS.TEMP,e,!1),console.log("[Playlist] 调用 playerStore.playSong"),t.playerStore.playSong(e),console.log("[Playlist] 播放完成")}catch(n){console.error("[Playlist] 播放失败:",n),t.playerStore.clearStatusText(),e.index.showToast({title:"播放失败",icon:"none"})}}})(l)},Ue=async()=>{var l;console.log("[locateCurrentSong] ========== 开始定位当前歌曲 ==========");const t=o.listStore.state.playInfo.playIndex,a=o.listStore.state.playInfo.playerListId,s=o.listStore.state.tempList.meta;console.log("[locateCurrentSong] 播放索引:",t,"列表ID:",a),console.log("[locateCurrentSong] 当前列表歌曲数:",Z.value.length);const i="trial"===G.value||G.value===o.LIST_IDS.DEFAULT?o.LIST_IDS.DEFAULT:"favorite"===G.value||G.value===o.LIST_IDS.LOVE?o.LIST_IDS.LOVE:G.value,n=a===o.LIST_IDS.TEMP&&s.id===G.value;if(a!==i&&!n)return console.warn("[locateCurrentSong] 当前没有播放本列表的歌曲"),void e.index.showToast({title:"当前没有播放本列表的歌曲",icon:"none"});if(t<0||t>=Z.value.length)return console.warn("[locateCurrentSong] 播放索引无效:",t,"列表长度:",Z.value.length),void e.index.showToast({title:"无法定位当前歌曲",icon:"none"});if(console.log("[locateCurrentSong] 目标歌曲索引:",t,"名称:",null==(l=Z.value[t])?void 0:l.name),ne.value)console.log("[locateCurrentSong] 使用虚拟列表 scrollToIndex:",t),ne.value.scrollToIndex(t,!0);else{const l=`virtual-item-${t}`;ie.value="",await e.nextTick$1(),ie.value=l,console.log("[locateCurrentSong] 降级使用 scrollIntoViewId:",l)}e.index.showToast({title:`已定位到第${t+1}首`,icon:"none",duration:1500}),console.log("[locateCurrentSong] ========== 定位完成 ==========")},Te=(e,l)=>{w.value=e,D.value=l,x.value=!0},xe=(e=!0)=>{x.value=!1,e&&(w.value=null,D.value=-1)},we=(e,l,o="custom")=>{console.log("[showPlaylistContextMenu] 显示歌单菜单，歌单:",e.name,"ID:",e.id,"类型:",o),console.log("[showPlaylistContextMenu] 歌单完整信息:",JSON.stringify(e)),console.log("[showPlaylistContextMenu] canAutoUpdate:",e.canAutoUpdate,"isFromImport:",e.isFromImport),b.value=e,k.value=l,A.value=o,_.value=!0},De=()=>{_.value=!1,b.value=null,k.value=-1,A.value="custom"},_e=()=>{if(!b.value)return;const l=b.value,t=A.value,a=l.name,s=l.id,i=l.coverImgUrl||"";De(),e.index.showModal({title:"重命名歌单",editable:!0,placeholderText:"请输入新名称",success:l=>{if(l.confirm&&l.content){const n=l.content.trim();if(!n)return void e.index.showToast({title:"名称不能为空",icon:"none"});if(n.length>100)return void e.index.showToast({title:"名称不能超过100个字符",icon:"none"});if(n===a)return void e.index.showToast({title:"名称未改变",icon:"none"});if(console.log("[renamePlaylist] 重命名歌单:",a,"->",n,"类型:",t),"imported"===t){const l=V.value.findIndex(e=>e.id===s);l>-1&&(V.value[l]={...V.value[l],name:n},e.index.setStorageSync("imported_playlists",V.value),console.log("[renamePlaylist] 导入歌单已重命名并保存"),V.value=[...V.value])}else o.listStore.updateUserList([{id:s,name:n,coverImgUrl:i}]),X();e.index.showToast({title:"重命名成功",icon:"success"})}}})},be=()=>{if(!b.value)return;const l="imported"===A.value;e.index.showModal({title:"提示",content:`确定删除歌单"${b.value.name}"吗？${l?"将从导入列表中移除，歌曲不会删除。":"删除后无法恢复。"}`,confirmText:"删除",confirmColor:"#ff4d4f",success:t=>{if(t.confirm){console.log("[removePlaylist] 开始移除歌单:",b.value.name,"ID:",b.value.id,"类型:",A.value);const t=o.listStore.state.playInfo.playerListId===b.value.id;if(G.value===b.value.id&&(console.log("[removePlaylist] 当前正在查看该歌单，清空列表并切换到试听列表"),Z.value=[],G.value="",fe("trial")),t){console.log("[removePlaylist] 播放器正在播放该歌单，更新播放列表"),o.listStore.setPlayerListId(o.LIST_IDS.DEFAULT);const e=o.listStore.state.defaultList.list;e.length>0?o.listStore.setPlayMusicInfo(o.LIST_IDS.DEFAULT,e[0],!1):o.listStore.setPlayMusicInfo(o.LIST_IDS.DEFAULT,null,!1)}if(l){console.log("[removePlaylist] 从导入歌单中移除");const l=V.value.findIndex(e=>e.id===b.value.id);l>-1&&(V.value.splice(l,1),e.index.setStorageSync("imported_playlists",V.value),console.log("[removePlaylist] 已从导入列表移除并保存，本地存储剩余:",V.value.length,"个"),V.value=[...V.value])}else console.log("[removePlaylist] 从自定义歌单中移除"),o.listStore.removeUserList([b.value.id]),X();De(),e.index.showToast({title:"已删除",icon:"success"})}}})},ke=e=>e&&Array.isArray(e)?e.map(e=>{var l,o;const t={id:e.id,name:e.name,singer:e.singer||(e.ar?e.ar.map(e=>e.name).join("/"):""),ar:e.ar||(e.singer?e.singer.split("/").map(e=>({name:e})):[]),album:e.album||e.albumName||(e.al?e.al.name:""),duration:e.duration||e.dt||e.interval,dt:e.dt||e.duration||e.interval,interval:e.interval||e.dt||e.duration,source:e.source};return e.songmid&&(t.songmid=e.songmid),e.hash&&(t.hash=e.hash),e.copyrightId&&(t.copyrightId=e.copyrightId),(e.img||e.albumPic||(null==(l=e.al)?void 0:l.picUrl))&&(t.img=e.img||e.albumPic||(null==(o=e.al)?void 0:o.picUrl)),t}):[],Ae=()=>{if(!b.value||"imported"!==A.value)return;const l=b.value;l.link?e.index.showModal({title:"同步歌单",content:`确定要同步歌单"${l.name}"吗？\n\n同步操作将会：\n• 重新从源头获取最新歌单内容\n• 完全覆盖当前歌单\n• 清除所有播放进度和收藏状态\n\n请确保您当前的网络连接正常。`,confirmText:"确定同步",cancelText:"取消",success:async o=>{var t,a,s,r,u,c,d,v;if(o.confirm){console.log("[syncPlaylist] 开始同步歌单:",l.name,"链接:",l.link,"平台:",l.source);try{let o;e.index.showLoading({title:"正在同步..."});if("tx"===l.source)console.log("[syncPlaylist] QQ音乐使用后端接口"),o=await i.getListDetail(l.source,l.link,1);else{console.log("[syncPlaylist] 使用前端直接API:",l.source);let s=l.link;if(/^https?:\/\//.test(l.link)){let o=l.link.match(/[?&]id=(\d+)/);if(o)s=o[1],console.log("[syncPlaylist] 从URL查询参数解析出ID:",s);else if(o=l.link.match(/\/playlist(?:_detail)?\/(\d+)/),o)s=o[1],console.log("[syncPlaylist] 从URL路径解析出ID:",s);else if("mg"===l.source&&l.link.includes("c.migu.cn")){console.log("[syncPlaylist] 检测到咪咕短链接，尝试获取真实URL...");try{const o=await e.index.request({url:l.link,method:"HEAD",header:{"User-Agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15"}}),i=(null==(t=o.header)?void 0:t.Location)||(null==(a=o.header)?void 0:a.location);if(i){console.log("[syncPlaylist] 咪咕短链接重定向到:",i);const e=i.match(/[?&]id=(\d+)/);e&&(s=e[1],console.log("[syncPlaylist] 从咪咕重定向URL解析出ID:",s))}}catch(g){console.error("[syncPlaylist] 获取咪咕短链接失败:",g)}}}else console.log("[syncPlaylist] 直接使用作为ID:",s);o=await n.getListDetailDirect(l.source,s,1)}const m=o.list||[];if(0===m.length)throw new Error("获取到0首歌曲，可能歌单已删除或无权限访问");const f=V.value.findIndex(e=>e.id===l.id);if(f>-1){const t=ke(m);V.value[f].songs=t,V.value[f].trackCount=m.length,V.value[f].coverImgUrl=(null==(s=o.info)?void 0:s.img)||o.coverImgUrl||l.coverImgUrl,V.value[f].name=(null==(r=o.info)?void 0:r.name)||o.name||l.name,((null==(u=o.info)?void 0:u.desc)||o.desc)&&(V.value[f].desc=(null==(c=o.info)?void 0:c.desc)||o.desc),e.index.setStorageSync("imported_playlists",V.value),console.log("[syncPlaylist] 歌单已更新并保存，歌曲数:",m.length),V.value=[...V.value],G.value===l.id&&(Z.value=[...m],l.name=(null==(d=o.info)?void 0:d.name)||o.name||l.name,l.coverImgUrl=(null==(v=o.info)?void 0:v.img)||o.coverImgUrl||l.coverImgUrl,l.trackCount=m.length,console.log("[syncPlaylist] 当前歌单已更新，歌曲数:",m.length))}De(),e.index.showToast({title:`同步成功（${m.length}首）`,icon:"success"})}catch(m){console.error("[syncPlaylist] 同步失败:",m);let l="同步失败";m.message&&(l=m.message.includes("404")||m.message.includes("not found")?"歌单不存在或已删除":m.message.includes("403")||m.message.includes("forbidden")?"没有权限访问该歌单":m.message.includes("network")||m.message.includes("网络")?"网络连接失败":`同步失败: ${m.message}`),e.index.showToast({title:l,icon:"none"})}finally{e.index.hideLoading()}}}}):e.index.showToast({title:"该歌单没有链接信息，无法同步",icon:"none"})},Ee=()=>{if(!b.value||"imported"!==A.value)return;const l=b.value,o=!l.autoUpdate,t=V.value.findIndex(e=>e.id===l.id);t>-1&&(V.value[t].autoUpdate=o,e.index.setStorageSync("imported_playlists",V.value),console.log("[toggleAutoUpdate] 自动更新状态已更新:",o),V.value=[...V.value],b.value.autoUpdate=o,e.index.showToast({title:o?"已开启自动更新":"已关闭自动更新",icon:"success"}))},Ce=async()=>{console.log("[batchAutoUpdatePlaylists] 开始批量自动更新检查");const e=V.value.filter(e=>e.autoUpdate&&e.canAutoUpdate);if(console.log("[batchAutoUpdatePlaylists] 开启自动更新的歌单数量:",e.length),0!==e.length){for(const o of e)if(W.value.has(o.id))console.log("[batchAutoUpdatePlaylists] 歌单已更新过，跳过:",o.name);else{console.log("[batchAutoUpdatePlaylists] 开始自动更新歌单:",o.name),M.value=!0,F.value=o.name;try{W.value.add(o.id),await Me(o,!1),console.log("[batchAutoUpdatePlaylists] 歌单自动更新成功:",o.name)}catch(l){console.error("[batchAutoUpdatePlaylists] 歌单自动更新失败:",o.name,l),W.value.delete(o.id)}await new Promise(e=>setTimeout(e,1e3))}console.log("[batchAutoUpdatePlaylists] 批量自动更新完成"),M.value=!1,F.value=""}else console.log("[batchAutoUpdatePlaylists] 没有开启自动更新的歌单，跳过")},Me=async(l,o=!0)=>{var t,a,s,r,u,c,d,v;console.log("[autoUpdatePlaylist] 开始自动更新歌单:",l.name,"链接:",l.link,"平台:",l.source);try{let m;if("tx"===l.source)console.log("[autoUpdatePlaylist] QQ音乐使用后端接口"),m=await i.getListDetail(l.source,l.link,1);else{console.log("[autoUpdatePlaylist] 使用前端直接API:",l.source);let o=l.link;if(/^https?:\/\//.test(l.link)){let s=l.link.match(/[?&]id=(\d+)/);if(s)o=s[1],console.log("[autoUpdatePlaylist] 从URL查询参数解析出ID:",o);else if(s=l.link.match(/\/playlist(?:_detail)?\/(\d+)/),s)o=s[1],console.log("[autoUpdatePlaylist] 从URL路径解析出ID:",o);else if("mg"===l.source&&l.link.includes("c.migu.cn")){console.log("[autoUpdatePlaylist] 检测到咪咕短链接，尝试获取真实URL...");try{const s=await e.index.request({url:l.link,method:"HEAD",header:{"User-Agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15"}}),i=(null==(t=s.header)?void 0:t.Location)||(null==(a=s.header)?void 0:a.location);if(i){console.log("[autoUpdatePlaylist] 咪咕短链接重定向到:",i);const e=i.match(/[?&]id=(\d+)/);e&&(o=e[1],console.log("[autoUpdatePlaylist] 从咪咕重定向URL解析出ID:",o))}}catch(g){console.error("[autoUpdatePlaylist] 获取咪咕短链接失败:",g)}}}else console.log("[autoUpdatePlaylist] 直接使用作为ID:",o);m=await n.getListDetailDirect(l.source,o,1)}const f=m.list||[];if(0===f.length)throw new Error("获取到0首歌曲，可能歌单已删除或无权限访问");const y=V.value.findIndex(e=>e.id===l.id);if(y>-1){const t=ke(f);return V.value[y].songs=t,V.value[y].trackCount=f.length,V.value[y].coverImgUrl=(null==(s=m.info)?void 0:s.img)||m.coverImgUrl||l.coverImgUrl,V.value[y].name=(null==(r=m.info)?void 0:r.name)||m.name||l.name,((null==(u=m.info)?void 0:u.desc)||m.desc)&&(V.value[y].desc=(null==(c=m.info)?void 0:c.desc)||m.desc),e.index.setStorageSync("imported_playlists",V.value),console.log("[autoUpdatePlaylist] 歌单已自动更新并保存，歌曲数:",f.length),V.value=[...V.value],G.value===l.id?(Z.value=[...t],Y.name=(null==(d=m.info)?void 0:d.name)||m.name||l.name,Y.coverImgUrl=(null==(v=m.info)?void 0:v.img)||m.coverImgUrl||l.coverImgUrl,Y.trackCount=f.length,console.log("[autoUpdatePlaylist] 当前歌单已自动更新，歌曲数:",f.length)):console.log("[autoUpdatePlaylist] 歌单在后台更新完成，当前显示的是其他歌单，不更新页面"),o&&e.index.showToast({title:`自动更新成功（${f.length}首）`,icon:"success"}),f}}catch(m){console.error("[autoUpdatePlaylist] 自动更新失败:",m);const e=l.songs||[];return Z.value=[...e],Y.name=l.name,Y.coverImgUrl=l.coverImgUrl,Y.trackCount=e.length,e}finally{M.value=!1}},Fe=()=>{w.value&&e.index.showModal({title:"提示",content:"确定从当前列表移除这首歌曲吗？",success:l=>{if(l.confirm){if(console.log("[removeSongFromList] 开始移除歌曲，歌单ID:",G.value,"歌曲ID:",w.value.id),"trial"===G.value||G.value===o.LIST_IDS.DEFAULT)console.log("[removeSongFromList] 从试听列表移除"),o.listStore.removeFromDefaultList(w.value.id);else if("favorite"===G.value||G.value===o.LIST_IDS.LOVE)console.log("[removeSongFromList] 从收藏列表移除（取消收藏）"),o.listStore.removeFromLoveList(w.value.id);else if(G.value.startsWith("custom_")||G.value.startsWith("userlist_")){console.log("[removeSongFromList] 从自定义歌单移除");const e=o.listStore.state.userLists.find(e=>e.id===G.value);if(e){const l=e.list.findIndex(e=>e.id===w.value.id);l>-1&&(e.list.splice(l,1),console.log("[removeSongFromList] 自定义歌单移除成功，保存数据"),o.listStore.saveUserLists())}}else{console.log("[removeSongFromList] 从导入的歌单移除，歌单ID:",G.value);const l=Z.value.findIndex(e=>e.id===w.value.id);l>-1&&(Z.value.splice(l,1),console.log("[removeSongFromList] 导入歌单移除成功，剩余歌曲:",Z.value.length),(()=>{console.log("[saveImportedPlaylist] 开始保存，歌单ID:",G.value);const l=V.value.findIndex(e=>e.id===G.value);if(l>-1){console.log("[saveImportedPlaylist] 找到歌单，索引:",l),V.value[l].songs=[...Z.value],V.value[l].trackCount=Z.value.length,console.log("[saveImportedPlaylist] 更新后的歌曲数量:",V.value[l].trackCount),e.index.setStorageSync("imported_playlists",V.value),console.log("[saveImportedPlaylist] 本地存储已保存");const o=[...V.value];V.value=o,console.log("[saveImportedPlaylist] 已触发响应式更新")}else console.warn("[saveImportedPlaylist] 未找到要保存的歌单，歌单ID:",G.value)})())}try{const l=e.index.getStorageSync("deleted_songs")||[];-1===l.findIndex(e=>e.id===w.value.id)&&(l.unshift(w.value),l.length>200&&l.pop(),e.index.setStorageSync("deleted_songs",l),console.log("[removeSongFromList] 已记录删除的歌曲，当前删除记录数:",l.length))}catch(t){console.error("[removeSongFromList] 记录删除歌曲失败:",t)}Ie(),e.index.showToast({title:"已移除",icon:"success"})}xe()}})},$e=(e,l="name",o="、")=>{if(!e)return"未知歌手";if(Array.isArray(e)){const t=[];return e.forEach(e=>{let o=e[l];o&&t.push(o)}),t.length>0?t.join(o):"未知歌手"}return String(e||"未知歌手")},Oe=()=>{var e;if(!w.value)return;console.log("[toggleMusicSource] 打开歌曲换源弹窗，歌曲:",w.value.name),console.log("[toggleMusicSource] 歌曲数据:",JSON.stringify(w.value));const l={...w.value};C.value=l,console.log("[toggleMusicSource] toggleOriginalSong已设置:",null==(e=C.value)?void 0:e.name),xe(!1),E.value=!0},je=()=>{E.value=!1,C.value=null},qe=l=>{const{originalSong:a,newSong:s,listId:i}=l;console.log("[handleToggleConfirm] 确认换源:",{from:a.name,to:s.name,listId:i});const n=Z.value.findIndex(e=>e.id===a.id);if(-1===n)return console.error("[handleToggleConfirm] 未找到原歌曲"),void e.index.showToast({title:"换源失败：未找到原歌曲",icon:"none"});const r=String(a.id||""),c=r.replace(/^(tx|wy|kg|kw|mg)_/,"")||r;console.log("[handleToggleConfirm] 保存换源信息, 原始歌曲ID:",c,"原始source:",a.source,"新source:",s.source),u.saveMusicSwitchSource(c,{originalSource:a.source,newSource:s.source,newSongId:s.id,newSongName:s.name,newSongSinger:s.singer,url:s.url||s.playUrl||"",quality:s.quality||"standard"}),console.log("[handleToggleConfirm] 已保存换源信息到本地存储, 新歌曲ID:",s.id);const d=o.listStore.state.playInfo.playerListId;o.listStore.state.playInfo.playIndex===n&&d===i&&(console.log("[handleToggleConfirm] 更新播放器中的歌曲信息"),t.playerStore.updateCurrentSong(s)),e.index.showToast({title:"换源成功",icon:"success"})},Ve=async l=>{var o;console.log("[handleTogglePreview] 预览歌曲:",l.name),console.log("[handleTogglePreview] 歌曲信息:",JSON.stringify(l)),$.value=!0,O.value="加载中",j.value="获取播放链接";try{const a=l.sourceId||l.source||"tx";console.log("[handleTogglePreview] 音源:",a);const i={...l,source:a},n=c.buildMusicRequestParams(i,"320k");if(!n)throw new Error("构建请求参数失败");console.log("[handleTogglePreview] 请求参数:",n);const u=await s.getMusicUrl(n);console.log("[handleTogglePreview] 获取到URL:",u.url);const d={...l,url:u.url,playUrl:u.url,lyric:u.lyric||"",tlyric:u.tlyric||"",rlyric:u.rlyric||"",lxlyric:u.lxlyric||""};u.fallback&&u.fallback.toggled&&(d.source=u.fallback.newSource,d._toggleMusicInfo={originalSource:u.fallback.originalSource,newSource:u.fallback.newSource,matchedSong:u.fallback.matchedSong,toggleTime:Date.now()},u.fallback.matchedSong&&(d.songmid=u.fallback.matchedSong.songmid||l.songmid,d.hash=u.fallback.matchedSong.hash||l.hash,d.copyrightId=u.fallback.matchedSong.copyrightId||l.copyrightId));const v=(null==(o=u.fallback)?void 0:o.newSource)||a;await r.setCachedMusicUrl(l.id,"320k",u.url,v),console.log("[handleTogglePreview] 播放URL已缓存:",l.id,"source:",v),t.playerStore.playSong(d),$.value=!1,e.index.showToast({title:`正在播放: ${l.name}`,icon:"none",duration:2e3})}catch(a){console.error("[handleTogglePreview] 播放失败:",a),$.value=!1,e.index.showToast({title:"播放失败: "+(a.message||"未知错误"),icon:"none",duration:2e3})}},ze=()=>{I.value=!1,L.value=""},Re=()=>{const l=L.value.trim();l?(I.value=!1,e.index.navigateTo({url:`/pages/sharelist/index?source=${U.value}&link=${encodeURIComponent(l)}&platform=${encodeURIComponent(T.value)}&preview=true&from=import`})):e.index.showToast({title:"请输入歌单链接",icon:"none"})},We=async()=>{console.log("[Playlist] ====== loadPlaylistData 开始 ======"),B.value=!0;const l=e.index.getStorageSync("imported_playlists")||[];V.value=l,console.log("[Playlist] 已导入歌单数量:",l.length);const t=(()=>{try{const l=e.index.getStorageSync(h);return console.log("[Playlist] 获取上次选择的歌单ID:",l),l||null}catch(l){return console.error("[Playlist] 获取歌单ID失败:",l),null}})();console.log("[Playlist] 上次选择的歌单ID:",t);let s=!1;if(t)if(console.log("[Playlist] 尝试恢复上次选择的歌单:",t),"trial"===t||t===o.LIST_IDS.DEFAULT)console.log("[Playlist] 恢复为试听列表"),G.value="trial",Y.id=o.LIST_IDS.DEFAULT,Y.name="试听列表",Y.description="试听列表，存放您最近试听的歌曲",z.value="",Z.value=[...o.listStore.state.defaultList.list],s=!0;else if("favorite"===t||t===o.LIST_IDS.LOVE)console.log("[Playlist] 恢复为我的收藏"),G.value="favorite",Y.id=o.LIST_IDS.LOVE,Y.name="我的收藏",Y.description="您收藏的歌曲",z.value="",Z.value=[...o.listStore.state.loveList.list],s=!0;else if(t.startsWith("custom_")||t.startsWith("userlist_")){const e=o.listStore.state.userLists.find(e=>e.id===t);e&&(console.log("[Playlist] 恢复自定义歌单:",e.name),G.value=e.id,Y.id=e.id,Y.name=e.name,Y.coverImgUrl=e.coverImgUrl||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",Y.description="自定义歌单",z.value="custom",Z.value=[...e.list||[]],s=!0)}else{const e=l.find(e=>e.id===t);if(e)if(console.log("[Playlist] 恢复导入歌单:",e.name),G.value=e.id,Y.id=e.id,Y.name=e.name,Y.coverImgUrl=e.coverImgUrl,Y.description=`从${e.platform}导入的歌单`,z.value=e.source||"",e.autoUpdate&&e.link&&!W.value.has(e.id)){console.log("[Playlist] 检测到自动更新已开启，开始自动同步歌单:",e.name),W.value.add(e.id);const l=e.songs||[];l.length>600&&($.value=!0,O.value="正在加载",j.value=`${l.length}首歌曲`),Me(e,!1).then(e=>{console.log("[Playlist] 自动更新完成，更新歌曲列表"),q.value=!1,e&&e.length>0?(le(e),$.value=!1):$.value=!1,Ce()}),Z.value=[...l],s=!0,l.length>600&&(q.value=!0)}else{const l=e.songs||[];le(l),s=!0,q.value=!1,Ce()}}if(q.value)console.log("[Playlist] 歌单正在加载中，等待加载完成");else{if(s)return console.log("[Playlist] 从上次选择的歌单恢复成功，currentPlaylistId:",G.value),console.log("[Playlist] ====== loadPlaylistData 结束 ======"),void Ce();try{const e=await a.getPlayInfo();console.log("[Playlist] 获取到 playInfo:",e);let t=!1;if(e&&e.listId&&e.index>=0)if(console.log("[Playlist] 尝试恢复上次播放状态 - listId:",e.listId,"index:",e.index),e.listId===o.LIST_IDS.DEFAULT||"trial"===e.listId)console.log("[Playlist] 恢复为试听列表"),G.value="trial",Y.id=o.LIST_IDS.DEFAULT,Y.name="试听列表",Y.description="试听列表，存放您最近试听的歌曲",z.value="",Z.value=[...o.listStore.state.defaultList.list],t=!0;else if(e.listId===o.LIST_IDS.LOVE||"favorite"===e.listId)console.log("[Playlist] 恢复为我的收藏"),G.value="favorite",Y.id=o.LIST_IDS.LOVE,Y.name="我的收藏",Y.description="您收藏的歌曲",z.value="",Z.value=[...o.listStore.state.loveList.list],t=!0;else if(e.listId===o.LIST_IDS.TEMP){if(console.log("[Playlist] 尝试恢复临时列表，playInfo.meta:",JSON.stringify(e.meta)),e.meta&&e.meta.id){const o=l.find(l=>l.id===e.meta.id);if(o){if(console.log("[Playlist] 从导入歌单中找到临时列表对应的歌单:",o.name),G.value=o.id,Y.id=o.id,Y.name=o.name,Y.coverImgUrl=o.coverImgUrl,Y.description=`从${o.platform}导入的歌单`,z.value=o.source||"",o.autoUpdate&&o.link&&!W.value.has(o.id))return console.log("[Playlist] 检测到自动更新已开启，开始自动同步歌单:",o.name),W.value.add(o.id),void Me(o,!1);const e=o.songs||[];le(e),t=!0}}}else{console.log("[Playlist] 尝试恢复歌单，listId:",e.listId);const a=l.find(l=>l.id===e.listId);if(console.log("[Playlist] 在已导入歌单中查找:",e.listId,"结果:",a?"找到":"未找到"),a){if(console.log("[Playlist] 找到匹配的导入歌单:",a.name),G.value=a.id,Y.id=a.id,Y.name=a.name,Y.coverImgUrl=a.coverImgUrl,Y.description=`从${a.platform}导入的歌单`,z.value=a.source||"",a.autoUpdate&&a.link&&!W.value.has(a.id))return console.log("[Playlist] 检测到自动更新已开启，开始自动同步歌单:",a.name),W.value.add(a.id),void Me(a,!1);const e=a.songs||[];le(e),t=!0}else{const l=o.listStore.state.userLists.find(l=>l.id===e.listId);if(l){console.log("[Playlist] 找到匹配的自定义歌单:",l.name),G.value=l.id,Y.id=l.id,Y.name=l.name,Y.coverImgUrl=l.coverImgUrl||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",Y.description="自定义歌单",z.value="custom";const e=l.list||[];le(e),t=!0}}}if(!t)if(console.log("[Playlist] 未找到有效的播放记录，使用默认逻辑"),l.length>0){const e=l[0];if(console.log("[Playlist] 自动选择第一个导入的歌单:",e.name),G.value=e.id,Y.id=e.id,Y.name=e.name,Y.coverImgUrl=e.coverImgUrl,Y.description=`从${e.platform||"未知平台"}导入的歌单`,z.value=e.source||"",e.autoUpdate&&e.link&&!W.value.has(e.id))return console.log("[Playlist] 检测到自动更新已开启，开始自动同步歌单:",e.name),W.value.add(e.id),void Me(e,!1);const o=e.songs||[];Z.value=[...o],console.log("[Playlist] 已加载歌曲:",Z.value.length,"首")}else if(o.listStore.state.userLists.length>0){const e=o.listStore.state.userLists[0];console.log("[Playlist] 自动选择第一个自定义歌单:",e.name),G.value=e.id,Y.id=e.id,Y.name=e.name,Y.coverImgUrl=e.coverImgUrl||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80",Y.description="自定义歌单",z.value="custom";const l=e.list||[];le(l)}else console.log("[Playlist] 使用默认列表"),Ie();console.log("[Playlist] 最终 currentPlaylistId:",G.value),console.log("[Playlist] ====== loadPlaylistData 结束 ======"),Ce()}catch(i){if(console.error("[Playlist] 恢复播放状态失败:",i),l.length>0){const e=l[0];G.value=e.id,Y.id=e.id,Y.name=e.name,Y.coverImgUrl=e.coverImgUrl,Y.description=`从${e.platform||"未知平台"}导入的歌单`,z.value=e.source||"";const o=e.songs||[];le(o)}else Ie()}}};e.onShow(()=>{if(l.setStatusBarTextColor("black"),K(),(()=>{var l;try{const o=e.index.getSystemInfoSync();J.value=(null==(l=o.safeAreaInsets)?void 0:l.bottom)||0,console.log("[Playlist] 底部高度初始化:",{safeAreaBottom:J.value})}catch(o){console.error("[Playlist] 获取底部高度失败:",o)}})(),(()=>{e.index.$on("miniPlayerHeightChange",e=>{Q.value=e.isShowing,console.log("[Playlist] MiniPlayer 状态变化:",e.isShowing)});const l=t.playerStore.getState().currentSong;Q.value=!(!l||!l.id)})(),console.log("[Playlist] ====== onShow ======"),console.log("[Playlist] isDataLoaded:",B.value),X(),console.log("[Playlist] onShow 刷新自定义歌单:",R.value.length,"个"),B.value){const l=e.index.getStorageSync("imported_playlists")||[];V.value=l,console.log("[Playlist] onShow 刷新已导入歌单:",l.length,"个"),console.log("[Playlist] 当前 currentPlaylistId:",G.value),Ne()}});const Ne=()=>{if(console.log("[Playlist] refreshCurrentPlaylist 当前歌单ID:",G.value),"trial"===G.value||G.value===o.LIST_IDS.DEFAULT){const e=o.listStore.state.defaultList.list||[];return Z.value=[...e],Y.id="trial",Y.name="试听列表",Y.trackCount=e.length,void console.log("[Playlist] 刷新试听列表，歌曲数:",e.length)}if("favorite"===G.value||G.value===o.LIST_IDS.LOVE){const e=o.listStore.state.loveList.list||[];return Z.value=[...e],Y.id="favorite",Y.name="我的收藏",Y.trackCount=e.length,void console.log("[Playlist] 刷新我的收藏，歌曲数:",e.length)}if(G.value&&(G.value.startsWith("custom_")||G.value.startsWith("userlist_"))){const e=o.listStore.state.userLists.find(e=>e.id===G.value);if(e){const l=e.list||[];Z.value=[...l],Y.id=e.id,Y.name=e.name,Y.trackCount=l.length,console.log("[Playlist] 刷新自定义歌单:",e.name,"歌曲数:",l.length)}else G.value="trial",Z.value=[...o.listStore.state.defaultList.list],Y.name="试听列表",console.log("[Playlist] 自定义歌单不存在，切换到试听列表");return}const l=(e.index.getStorageSync("imported_playlists")||[]).find(e=>e.id===G.value);if(l){const e=l.songs||[];Z.value=[...e],Y.id=l.id,Y.name=l.name,Y.trackCount=e.length,console.log("[Playlist] 刷新导入歌单:",l.name,"歌曲数:",e.length)}else G.value="trial",Z.value=[...o.listStore.state.defaultList.list],Y.name="试听列表",console.log("[Playlist] 导入歌单不存在，切换到试听列表")};return e.onReachBottom(()=>{console.log("[Playlist] onReachBottom 触发"),loadMoreSongs()}),(l,t)=>{var a,s,i,n,r,u,c,v,m,h,U,T;return e.e({a:e.t(Y.name),b:e.p({name:"chevron-down",size:"16",color:N.value?"#fff":"#666"}),c:e.o(ve),d:e.s(f.value),e:g.value},g.value?{f:e.o(ge)}:{},{g:e.p({name:"music",size:"20",color:"#00d7cd"}),h:e.t(p.value),i:"trial"===G.value?1:"",j:e.o(e=>fe("trial")),k:e.p({name:"heart",size:"20",color:"#ff6b6b"}),l:e.t(S.value),m:"favorite"===G.value?1:"",n:e.o(e=>fe("favorite")),o:V.value.length>0},V.value.length>0?{p:e.f(V.value,(l,o,t)=>({a:e.unref(d.proxyImageUrl)(l.coverImgUrl),b:e.o(e=>me(e,l),l.id),c:e.t(l.name),d:e.t(l.trackCount||0),e:e.t(l.platform),f:"af680a54-3-"+t,g:e.o(e=>we(l,o,"imported"),l.id),h:l.id,i:G.value===l.id?1:"",j:e.o(e=>(e=>{if(q.value)return void console.log("[Playlist] 歌单正在加载中，阻止切换");if(console.log("========== [Playlist] selectImportedPlaylist 被调用 =========="),console.log("[Playlist] 传入的歌单:",JSON.stringify({id:e.id,name:e.name})),console.log("[Playlist] 当前 currentPlaylistId:",G.value),G.value===e.id)return console.log("[Playlist] 歌单已选中，关闭侧边栏"),void(g.value=!1);G.value=e.id,g.value=!1,H(e.id),Y.id=e.id,Y.name=e.name,Y.coverImgUrl=e.coverImgUrl,Y.description=`从${e.platform}导入的歌单`,z.value=e.source||"";const l=e.songs||[];le(l),se.value=0,console.log("[Playlist] 选择已导入歌单:",e.name,"歌曲数量:",l.length),console.log("========== [Playlist] selectImportedPlaylist 完成 ==========")})(l),l.id)})),q:e.p({name:"ellipsis-vertical",size:"18"})}:{},{r:R.value.length>0},R.value.length>0?{s:e.f(R.value,(l,o,t)=>({a:e.unref(d.proxyImageUrl)(l.coverImgUrl),b:e.o(e=>me(e,l),l.id),c:e.t(l.name),d:e.t(l.trackCount||0),e:"af680a54-4-"+t,f:e.o(e=>we(l,o,"custom"),l.id),g:l.id,h:G.value===l.id?1:"",i:e.o(e=>fe(l.id),l.id)})),t:e.p({name:"ellipsis-vertical",size:"18"})}:{},{v:e.o(pe),w:e.o(he),x:g.value?1:"",y:e.s(y.value),z:e.p({name:"location-crosshairs",size:"18",color:"#fff"}),A:e.o(Ue),B:e.sr(ne,"af680a54-6",{k:"virtualListRef"}),C:e.o(Pe),D:e.o(ue),E:e.o(ce),F:e.o(de),G:e.p({items:Z.value,"item-height":60,height:re.value,"buffer-size":10,loading:ee.value,"current-play-index":ae.value,"is-playing":te.value,"dark-mode":N.value}),H:e.p({"current-index":2}),I:I.value},I.value?{J:e.t(P.value),K:e.p({name:"xmark",size:"20",color:"#999"}),L:e.o(ze),M:L.value,N:e.o(e=>L.value=e.detail.value),O:e.o(ze),P:e.o(Re),Q:e.o(()=>{}),R:e.o(ze)}:{},{S:x.value},x.value?e.e({T:w.value},w.value?{U:e.t(w.value.name),V:e.t($e(w.value.ar||w.value.singer))}:{},{W:e.p({type:"fas",name:"rotate",size:"20",color:"#3b82f6"}),X:e.o(Oe),Y:e.p({type:"fas",name:"trash",size:"20",color:"#ef4444"}),Z:e.t("favorite"===G.value.value||G.value.value===e.unref(o.LIST_IDS).LOVE?"取消收藏并移除":"从列表中移除"),aa:e.o(Fe),ab:e.o(()=>{}),ac:e.o(xe)}):{},{ad:_.value},_.value?e.e({ae:b.value},b.value?{af:e.t(b.value.name),ag:e.t("imported"===A.value?`从${b.value.platform||""}导入`:"自定义歌单")}:{},{ah:e.p({type:"fas",name:"pen",size:"20",color:"#3b82f6"}),ai:e.o(_e),aj:"imported"===A.value&&(null==(a=b.value)?void 0:a.canAutoUpdate)&&(null==(s=b.value)?void 0:s.isFromImport)},"imported"===A.value&&(null==(i=b.value)?void 0:i.canAutoUpdate)&&(null==(n=b.value)?void 0:n.isFromImport)?{ak:e.p({type:"fas",name:(null==(r=b.value)?void 0:r.autoUpdate)?"check-circle":"clock-rotate-left",size:"20",color:(null==(u=b.value)?void 0:u.autoUpdate)?"#10b981":"#999"}),al:e.t((null==(c=b.value)?void 0:c.autoUpdate)?"已开启自动更新":"开启自动更新"),am:(null==(v=b.value)?void 0:v.autoUpdate)?"#10b981":"#999",an:e.o(Ee)}:{},{ao:"imported"===A.value&&(null==(m=b.value)?void 0:m.canAutoUpdate)&&(null==(h=b.value)?void 0:h.isFromImport)},"imported"===A.value&&(null==(U=b.value)?void 0:U.canAutoUpdate)&&(null==(T=b.value)?void 0:T.isFromImport)?{ap:e.p({type:"fas",name:"rotate",size:"20",color:"#10b981"}),aq:e.o(Ae)}:{},{ar:e.p({type:"fas",name:"trash",size:"20",color:"#ef4444"}),as:e.o(be),at:e.o(()=>{}),av:e.o(De)}):{},{aw:e.o(je),ax:e.o(qe),ay:e.o(Ve),az:e.p({visible:E.value,"original-song":C.value,"list-id":G.value,"dark-mode":N.value}),aA:e.p({visible:M.value,"playlist-name":F.value}),aB:e.p({visible:$.value,title:O.value,subtitle:j.value}),aC:N.value?1:""})}}},P=e._export_sfc(I,[["__scopeId","data-v-af680a54"]]);wx.createPage(P);
