"use strict";const o=require("../../common/vendor.js"),t=require("../config.js"),e={wy:"网易云音乐",kg:"酷狗音乐",kw:"酷我音乐",tx:"QQ音乐",mg:"咪咕音乐"};exports.formatDuration=function(o){return o?"string"==typeof o&&o.includes(":")?o:`${Math.floor(o/6e4)}:${Math.floor(o%6e4/1e3).toString().padStart(2,"0")}`:"0:00"},exports.formatPlayCount=function(o){return o?"string"==typeof o?o:o>=1e8?(o/1e8).toFixed(1)+"亿":o>=1e4?(o/1e4).toFixed(1)+"万":o.toString():"0"},exports.getListDetail=async function(n,i,r=1){var s,a,l,d,c,g;try{const r=await new Promise((e,r)=>{o.index.request({url:`${t.getServerUrl()}/api/songlist/detail/by-link`,method:"POST",header:{"Content-Type":"application/json"},data:{link:i,source:n},success:o=>{var t;200===o.statusCode&&o.data?e(o.data):r(new Error((null==(t=o.data)?void 0:t.message)||"获取歌单失败"))},fail:o=>{r(new Error("网络请求失败: "+(o.errMsg||"未知错误")))}})}),u=r.data||r,m=u.list||u.songs||[];if(m.length>0&&(console.log("[songlist.js] 第一首歌完整数据:",JSON.stringify(m[0])),console.log("[songlist.js] 第一首歌字段:",Object.keys(m[0]).join(", ")),"mg"===n)){const o=m[0];console.log("[songlist.js] 咪咕音乐歌曲关键字段:",{id:o.id,songmid:o.songmid,songId:o.songId,copyrightId:o.copyrightId,name:o.name})}return{list:m,page:u.page||1,limit:u.limit||1e3,total:u.total||m.length||0,source:u.source||n,sourceName:e[n]||"未知平台",id:(null==(s=u.parsed)?void 0:s.id)||u.id||"",info:{name:(null==(a=u.info)?void 0:a.name)||u.name||"未知歌单",img:(null==(l=u.info)?void 0:l.img)||u.img||u.cover||"",desc:(null==(d=u.info)?void 0:d.desc)||u.desc||u.description||"",author:(null==(c=u.info)?void 0:c.author)||u.author||u.creator||"",play_count:(null==(g=u.info)?void 0:g.play_count)||u.play_count||u.playCount||"0"}}}catch(u){throw console.error("[getListDetail] 获取歌单详情失败:",u),u}};
