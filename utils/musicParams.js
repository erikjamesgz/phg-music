"use strict";const a=a=>{if(console.log("[formatDuration] 输入:",a,"类型:",typeof a),!a)return console.log("[formatDuration] 返回默认值: 0:00"),"0:00";let e=0;if("string"==typeof a){if(a.includes(":"))return console.log("[formatDuration] 已是 mm:ss 格式:",a),a;e=parseInt(a)}else"number"==typeof a&&(e=Math.floor(a/1e3));const s=`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`;return console.log("[formatDuration] 输出:",s),s};exports.buildMusicRequestParams=(e,s="320k")=>{if(console.log("[buildMusicRequestParams] 开始构建参数:",{hasSong:!!e,songId:null==e?void 0:e.id,songName:null==e?void 0:e.name,songSource:null==e?void 0:e.source,songDuration:null==e?void 0:e.duration,songDt:null==e?void 0:e.dt,songInterval:null==e?void 0:e.interval}),!e)return console.error("[buildMusicRequestParams] 歌曲信息无效"),null;const o=e.source||"tx",i=e.name||"",n=(a=>a.singer?a.singer:a.ar&&Array.isArray(a.ar)?a.ar.map(a=>a.name).join("/"):a.artists&&Array.isArray(a.artists)?a.artists.map(a=>a.name).join("/"):"")(e),r=(a=>a.album?a.album:a.albumName?a.albumName:a.al&&a.al.name?a.al.name:a.album&&"object"==typeof a.album&&a.album.name?a.album.name:"")(e),t=e.dt||e.duration||e.interval;console.log("[buildMusicRequestParams] durationValue:",t);const u=a(t);console.log("[buildMusicRequestParams] formatted interval:",u);let l=null;switch(o){case"tx":l={source:"tx",musicInfo:{id:e.songmid||e.id,name:i,singer:n,source:"tx",interval:u,meta:{songId:e.songmid||e.id,albumName:r,hash:e.songmid||e.id}},quality:s};break;case"wy":l={source:"wy",musicInfo:{id:e.id,name:i,singer:n,source:"wy",interval:u,meta:{songId:e.id,albumName:r,hash:e.id}},quality:s};break;case"kg":l={source:"kg",musicInfo:{id:e.id,name:i,singer:n,source:"kg",interval:u,meta:{songId:e.id,albumName:r,hash:e.hash||e.id}},quality:s};break;case"kw":l={source:"kw",musicInfo:{id:e.id,name:i,singer:n,source:"kw",interval:u,meta:{songId:e.id,albumName:r,hash:e.id}},quality:s};break;case"mg":const a=e.songmid||e.songId||e.id,t=e.copyrightId||e.id;l={source:"mg",songmid:a,id:t,musicInfo:{songmid:a,copyrightId:t,name:i,singer:n,source:"mg",interval:u,album:r,meta:{songId:a,albumName:r,copyrightId:t}},quality:s};break;default:l={source:o,musicInfo:{id:e.id,name:i,singer:n,source:o,interval:u,meta:{songId:e.id,albumName:r,hash:e.id}},quality:s}}return console.log("[buildMusicRequestParams] 构建请求参数:",{source:o,songId:e.id,songmid:e.songmid,hash:e.hash,quality:s,duration:e.duration,dt:e.dt,interval:e.interval,formattedInterval:u}),console.log("[buildMusicRequestParams] 返回的 requestData:",JSON.stringify(l)),l},exports.formatDuration=a;
