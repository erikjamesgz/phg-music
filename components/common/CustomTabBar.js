"use strict";const e=require("../../common/vendor.js"),t={props:{currentIndex:{type:Number,required:!0}},data:()=>({activeColor:"#00afff",platform:"",safeAreaInsetBottom:0,isDarkMode:!1,list:[{pagePath:"/pages/index/index",text:"首页",icon:"house"},{pagePath:"/pages/search/index",text:"搜索",icon:"magnifying-glass"},{pagePath:"/pages/playlist/index",text:"列表",icon:"list-ul"},{pagePath:"/pages/my/index",text:"我的",icon:"user"}]}),computed:{platformClass(){return"ios"===this.platform||"devtools"===this.platform?"is-ios":"is-android"}},mounted(){var t;const o=e.index.getSystemInfoSync();this.platform=o.platform||"android",this.safeAreaInsetBottom=(null==(t=o.safeAreaInsets)?void 0:t.bottom)||0,this.updateDarkMode(),console.log("[CustomTabBar] 系统信息:",o),console.log("[CustomTabBar] 平台:",this.platform),console.log("[CustomTabBar] safeAreaInsets:",o.safeAreaInsets),console.log("[CustomTabBar] safeAreaInsetBottom:",this.safeAreaInsetBottom),console.log("[CustomTabBar] 深色模式:",this.isDarkMode);const s=getCurrentPages(),a=s[s.length-1];if(a){const e=a.onShow;a.onShow=()=>{this.updateDarkMode(),e&&e.call(a)}}},methods:{switchTab(t){this.currentIndex!==t&&(this.$emit("before-switch",t),setTimeout(()=>{e.index.switchTab({url:this.list[t].pagePath})},200))},getIconName(e,t){return 0===t&&0===this.currentIndex?"house":e},updateDarkMode(){const t="false"!==e.index.getStorageSync("followSystem"),o="true"===e.index.getStorageSync("darkMode");if(t){const t=e.index.getSystemInfoSync();if(t.theme)this.isDarkMode="dark"===t.theme;else try{const t=e.index.createMediaQueryObserver();t&&t.observe({prefersColorScheme:"dark"},e=>{this.isDarkMode=e.matches})}catch(s){this.isDarkMode=!1}}else this.isDarkMode=o;console.log("[CustomTabBar] 更新深色模式状态:",this.isDarkMode,"跟随系统:",t)}}};if(!Array){e.resolveComponent("roc-icon-plus")()}Math;const o=e._export_sfc(t,[["render",function(t,o,s,a,r,n){return{a:e.f(r.list,(t,o,a)=>({a:"406198bf-0-"+a,b:e.p({name:n.getIconName(t.icon,o),size:s.currentIndex===o?22:20,color:s.currentIndex===o?r.activeColor:r.isDarkMode?"#9ca3af":"#8a8a8a"}),c:e.t(t.text),d:e.n({active:s.currentIndex===o}),e:o,f:s.currentIndex===o?1:"",g:e.o(e=>n.switchTab(o),o)})),b:e.n(n.platformClass),c:e.n({"dark-mode":r.isDarkMode})}}],["__scopeId","data-v-406198bf"]]);wx.createComponent(o);
